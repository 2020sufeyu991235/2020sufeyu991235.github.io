---
title: 数字证书(SSL)详解
authod: cotes
date: 2022-11-18 18:17:00 +0800
categories: [数字证书]
---

## 证书字段
>首先我们随便找一个证书查看，点击浏览器网址左边的小锁，点击“连接安全”，再点击右上角×旁边的按钮，选择详细信息，即可查看证书的具体字段信息，重点查看几个字段：
{: .prompt-tip}

1. 证书签名算法：使用 RSA 加密的 PKCS #1 SHA-256  
   采用哈希算法SHA-256对证书元数据计算生成数字摘要（一串数字），然后用颁发者的私钥对数字摘要进行RSA加密，生成数字签名，而PKCS #1 是RSA密码编译标准。

2. 主题：CN = *.jiansu.ml  
   证书所有者，CN（公用名称，Common Name）字段对于SSL证书一般为网站域名。

3. 使用者公钥信息
   - 使用者公钥算法：PKCS #1 RSA 加密
   - 使用者公钥：……

4. 证书签名值：……

<br>

## 申请证书
1. 申请者将公钥和个人信息发送给证书商(CA)
2. CA使用上面提到的`证书签名算法`对证书元数据(即我们能从证书上获取到的信息)进行签名生成数字摘要。
3. 然后CA使用自己的私钥对这段数字摘要进行加密，这就是证书上的`证书签名值`。
4. CA返回证书。

<br>

## 证书识别
1. 用户向网站请求证书。
2. 用户使用**证书商(CA)的公钥**对`证书签名值`解密，获取到数字摘要。
3. 用户对证书元数据采用`证书签名算法`中同样的算法进行签名，如果获得的数字摘要和上面一致，说明证书信息没有经过篡改。
- - -
>2中所说的证书商(CA)公钥如何获取？
{: .prompt-tip}
回到我们开始看到的证书，在`详细信息`中有一个`证书层次结构`，当前网站证书的上一级就是该证书的颁发者，其`使用者公钥`就是用于当前`证书签名值`解密的公钥。

>3中说明证书信息没有经过篡改是否就表示证书可靠？
{: .prompt-tip}
答案是否定的，我们还需要判断颁发者证书是否有效，这就需要获取更上一级的公钥解密，而这证书层次结构就被称为`证书链`。

>当然这又带来一个问题，该如何判断顶端颁发者证书的有效性？
{: .prompt-tip}
很简单，在本地中有一张白名单，在白名单中的证书默认是可信，这些默认证书可以在浏览器的管理证书中找到。

<br>

## 证书验证之后
1. 用户(浏览器)随机生成对称密钥。
2. 用户使用证书中的`使用者公钥`对`对称密钥`加密发送给网站服务器。
3. 用户和服务器通过该对称密钥进行加密通信。